$(document).ready(()=>{function a(){$(".song-table").empty();for([i,song]of c.entries()){let a=$("<td>").addClass("no-border"),b=$("<td>").addClass("no-border"),c=$("<td>").addClass("no-border"),d=$("<td class='no-border text-center pt-3 song-button text-random delete'><i class='fa fa-times'></i></td>");a.text(i+1).attr("scope","row"),b.text(song.songName),c.text(song.songArtist);let e=$("<tr>").append(a,b,c,d).attr("id",i);$(".song-table").append(e)}d||$("#table-songs").tableDnDUpdate()}function b(){for(let a=0;a<c.length;a++)c[a].songPosition=a}let c=[];const d=window.matchMedia("only screen and (max-width: 760px)").matches;$(".alert").hide(),$(function(){$("[data-hide]").on("click",function(){$(this).closest("."+$(this).attr("data-hide")).slideToggle()})}),$(".random-color").each(function(){$(this).css("color",randomColor({luminosity:"bright"}))}),$(".random-light").each(function(){$(this).css("color",randomColor({luminosity:"light"}))}),$(".text-random").mouseleave(()=>{$("*").css("--random-color",randomColor()),$("*").css("--random-dark",randomColor({luminosity:"dark"}))}),function(){let a=$("#last-login").attr("data-date"),b=$("#date-created").attr("data-date");$("#last-login").text(moment(a).format("MMMM Do")),$("#date-created").text(moment(b).format("MMMM Do"))}(),d||$("#table-songs").tableDnD({onDrop:b=>{let d=b.tBodies[0].rows,e=[];for(let a=0;a<d.length;a++)e.push(+d[a].id);c.sort(function(c,a){return e.indexOf(c.songPosition)-e.indexOf(a.songPosition)});for(let a=0;a<c.length;a++)c[a].songPosition=a;a()}}),$(".author-link").on("click",function(a){a.preventDefault(),a.stopImmediatePropagation(),author=$(this).text(),window.location.replace("/user/"+author)}),$("a").on("click",function(a){a.stopImmediatePropagation()}),$("#add-song").on("click",function(b){console.log(c),b.preventDefault(),b.stopPropagation();let d=$("#song-name").val().trim();d?$("#song-name").removeClass("is-invalid"):$("#song-name").addClass("is-invalid");let e=$("#song-artist").val().trim();e?$("#song-artist").removeClass("is-invalid"):$("#song-artist").addClass("is-invalid"),$(".song-div input").hasClass("is-invalid")||(c.push({songName:d,songArtist:e,songPosition:c.length}),a(),console.log(c),$("#song-name").val(""),$("#song-artist").val("")),console.log("Missing Data")}),$(".song-table").on("click",".delete",function(d){d.preventDefault(),c.splice($(this).parent().attr("id"),1),$(this).parent().remove(),b(),a()}),$("#submit-playlist").on("click",function(a){a.preventDefault();let b=$("#playlist-title").val().trim();b?$("#playlist-title").removeClass("is-invalid"):$("#playlist-title").addClass("is-invalid");let d=$("#playlist-description").val().trim();d?$("#playlist-description").removeClass("is-invalid"):$("#song-name").addClass("playlist-description"),$("input").hasClass("is-invalid")?console.log("Fields are missing"):0===c.length?($("#alert-text").text("Playlist is empty"),$(".alert").show()):$.post("/api/playlists",{playlistTitle:b,playlistDescription:d,playlistContents:c}).done(a=>{console.log(a),location.reload()}).fail(function(a){console.log(a.responseJSON.message),$("#alert-text").text(a.responseJSON.message),$(".alert").addClass("show")})}),$(".collapse").on("show.bs.collapse",function(){console.log("collapse hide"),$(this).prev(".card-header").find(".fa-plus-circle").removeClass("fa-plus-circle").addClass("fa-minus-circle")}).on("hide.bs.collapse",function(){$(this).prev(".card-header").find(".fa-minus-circle").removeClass("fa-minus-circle").addClass("fa-plus-circle")})});